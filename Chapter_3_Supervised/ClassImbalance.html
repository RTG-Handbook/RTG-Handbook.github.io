
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7. Tackling class imbalance &#8212; Handbook on real-time governance for identity systems</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://rtg-handbook.github.io/Chapter_3_Supervised/ClassImbalance.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Choosing the right metric" href="Metrics.html" />
    <link rel="prev" title="6. Exploratory Data Analysis" href="EDA.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/ATI_logo_black_W1024px.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Handbook on real-time governance for identity systems</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Foreword
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_Foreword/Foreword.html">
   Foreword
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_Foreword/Contributions.html">
   Contributions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I Background
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2_Background/Introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2_Background/IdentityFraud.html">
   2. Fraud scenarios in identity systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2_Background/FDS.html">
   3. Fraud detection system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2_Background/Challenges.html">
   4. Overview of challenges
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  II Supervised Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   5. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="EDA.html">
   6. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   7. Tackling class imbalance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Metrics.html">
   8. Choosing the right metric
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_References/bibliography.html">
   9. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Chapter_3_Supervised/ClassImbalance.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#smote-synthetic-minority-over-sampling-technique">
   7.1. SMOTE: Synthetic Minority Over-Sampling Technique
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="tackling-class-imbalance">
<span id="id1"></span><h1><span class="section-number">7. </span>Tackling class imbalance<a class="headerlink" href="#tackling-class-imbalance" title="Permalink to this headline">¶</a></h1>
<p>The challenge of working with imbalanced datasets is that most machine
learning algorithms will ignore, and in turn have poor performance on, the
minority class, although particularly in the case of rare event
detection, it is performance on the minority class that is most important.
Popular approaches for tacking class imbalance are based on sampling and
they can be classified into three categories:</p>
<ol class="simple">
<li><p><strong>Over-sampling</strong>, by adding more examples of the minority class
so it has more effect on the machine learning algorithm. In over-sampling,
instead of creating exact copies of the minority class examples, we can
introduce small variations into those copies, creating more diverse synthetic
samples.</p></li>
<li><p><strong>Under-sampling</strong>, by removing some examples of the majority
class so it has less effect on the machine learning algorithm. In
under-sampling we can cluster the examples of the majority class, and do
the under-sampling by removing examples from each cluster, thus seeking to
preserve information.</p></li>
<li><p><strong>Hybrid</strong>, a mix of over-sampling and under-sampling.</p></li>
</ol>
<div class="section" id="smote-synthetic-minority-over-sampling-technique">
<h2><span class="section-number">7.1. </span>SMOTE: Synthetic Minority Over-Sampling Technique<a class="headerlink" href="#smote-synthetic-minority-over-sampling-technique" title="Permalink to this headline">¶</a></h2>
<p>As listed above, one approach to addressing imbalanced datasets is to
over-sample the minority class. The simplest approach involves duplicating
examples in the minority class, although these examples don’t add any new
information to the model. Instead, new examples can be synthesised from
the existing examples by introducing small variations and is referred to
as the Synthetic Minority Oversampling Technique <span id="id2">[<a class="reference internal" href="../Chapter_References/bibliography.html#id25">CBHK02</a>]</span>,
or SMOTE for short.</p>
<p>SMOTE works by selecting examples that are close in the feature space,
drawing a line between the examples in the feature space and creating a
new sample at a point along that line. Specifically, a random example
from the minority class is first chosen. Then k of the nearest
neighbours for that example are found (typically k=5). A randomly
selected neighbour is chosen and a synthetic example is created at a
randomly selected point between the two examples in feature space.</p>
<p>The approach is effective because new synthetic examples from the
minority class are created that are plausible as they are relatively
close in feature space to existing examples from the minority class.
A general downside of the approach is that synthetic examples are
created without considering the majority class, possibly resulting
in ambiguous examples if there is a strong overlap for the classes.</p>
<p>We apply SMOTE to balance the classes in our dataset and assess its
impact in the following ways. Fig. 8 gives the absolute
difference of the mutual information (MI) among all pairs of features
between transactions grouped by the target <code class="docutils literal notranslate"><span class="pre">isFraud</span></code>. The results
are shown before (top) and after (bottom) the application of SMOTE. The
absolute differences of MI are comparatively higher after SMOTE
indicating that the pairwise feature relationships are more distinct
between the two classes after balancing.</p>
<p><img alt="alt text" src="../_images/MI_after_smote.pdf" /></p>
<p style="text-align: center;">
Fig. 8. The absolute difference of the mutual information (MI) between transactions grouped by `isFraud` before (left) and after (right) applying the SMOTE technique to balance the classes. The absolute differences of MI are higher after SMOTE indicating that the pairwise feature relationships are more distinct between the two classes after balancing.
</p>
<p>A popular method for exploring high-dimensional data is t-SNE, introduced
by <span id="id3">[<a class="reference internal" href="../Chapter_References/bibliography.html#id26">MH08</a>]</span>, an unsupervised and non-linear
dimensionality reduction technique. Fig. 9 gives the
results of applying t-SNE to visualise the dataset in a reduced
two-dimensional space both before (top) and after (bottom) using SMOTE to
balance the classes. The classes appear to be relatively more separable
after the application of SMOTE.</p>
<p><img alt="alt text" src="../_images/tsne_smote.pdf" /></p>
<p style="text-align: center;">
Fig. 7.Dimensionality reduction using t-SNE before (left) and after (right) using SMOTE to balance the classes. The classes appear to be more separable after the application of SMOTE.
</p></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapter_3_Supervised"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="EDA.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6. </span>Exploratory Data Analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Metrics.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Choosing the right metric</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By <a href="https://www.turing.ac.uk/research/research-projects/trustworthy-digital-infrastructure-identity-systems">Santhosh Narayanan</a>.<br/>
        
          <div class="extra_footer">
            <p>
Code released under a <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU GPL v3.0 license</a>. 
Prose and pictures released under a <a href="https://creativecommons.org/licenses/by-sa/4.0/"> CC BY-SA 4.0 license</a>.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>